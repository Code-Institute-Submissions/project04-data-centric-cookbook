{% extends 'base.html' %}

{% block template_content %}
<!-- PAGE HEADER -->
<section class="section-heading">
    <div class="container-fluid">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <h1>My Recipes</h1>
                    <h3 class="section-subheading text-muted">Manage your recipes.</h3>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- PAGE CONTENT -->
<section class="section-content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="container-fluid">
                    <!-- User Recipes -->
                    <div class="row">
                        <div class="col-md-12">
                            <p>You have {{total_count}} recipes in total.</p>
                        </div>
                    </div>
                    {% if total_count == 0 %}
                    <div class="row">
                            <div class="col-12"></div>
                    </div>
                    {%else%}
                    <div class="row"><div class="col-12"><span>Number of pages: {{ number_of_pages }}</span></div></div>
                    <div class="row">
                        <div class="col-12">
                            <span class="prev-span">
                                <a href="{{prev_url}}" class="previous">&lt;&lt; Previous page</a>
                            </span>
                            <span>
                                <a href="{{next_url}}" class="next">Next page &gt;&gt;</a>
                            </span>
                        </div>
                    </div>
                    {%endif%}
                    <div class="row">
                        <div class="col-2 myrecipe-table-title">Name</div>
                        <div class="col-2 d-none d-sm-table-cell d-md-block myrecipe-table-title">Description</div>
                        <div class="col-2 text-center myrecipe-table-title">Votes</div>
                        <div class="col-2 text-center myrecipe-table-title">Created</div>
                        <div class="col-4 text-center myrecipe-table-title">Manage Recipes</div>
                    </div>
                    <div class="row">
                        {% for recipe in recipes if recipes %}
                        <div class="col-2">
                            <span>{{recipe.name }}</span>
                        </div>
                        <div class="col-2 d-none d-sm-table-cell d-md-block">
                            {{ recipe.description|truncate(50, False, '...', 0) }}
                        </div>
                        <div class="col-2 text-center">{{ recipe.votes }}</div>
                        <div class="col-2 text-center">{{recipe['_id'].generation_time.date().strftime('%d %m %Y')}}</div>
                        <div class="col-4 text-center">
                            <div class="row">
                                <div class="col-12 col-md-4">
                                    <a href="{{ url_for('edit_recipe', recipe_id=recipe._id) }}" class="btn btn-primary"
                                        type="button" id="editRecipeButton">Edit</a>
                                </div>
                                <div class="col-12 col-md-4">
                                    <a href="#" type="button" class="btn btn-primary delete_recipe" id="{{recipe._id}}">Delete</a>
                                </div>
                                <div class="col-12 col-md-4">
                                    <a href="{{ url_for('view_recipe', recipe_id=recipe._id) }}" type="button" class="btn btn-primary"
                                        id="viewRecipeButton">View</a>
                                </div>
                            </div>
                        </div>
                        <div id="confirm_delete" title="Delete Recipe" style="display:none">
                            <p><span class="ui-icon ui-icon-alert ml-auto mr-auto" style="float:left; margin:12px 12px 20px 0;"></span>
                                This recipe will be deleted<br>Are you sure?</p>
                        </div>{{listing}}
                        {% else %}
                        <div class="col-12 pt-5">You have not added any recipes yet. You can add recipes <a href="/add_recipe" title="Add a recipe">here</a></div>

                        {% endfor %}
                    </div>
                    <div id="myrecipesMessages"></div>
                </div>

            </div>
        </div>
    </div>
</section>
<!--BACK TO TOP -->
<div class="row">
    <div class="col-12">
        <button onclick="topFunction()" id="backtotopIcon" title="Go to top"></button>
    </div>
</div>

{% endblock %}


<!-- Debug area. Hidden if debug set to False -->
{% block content_debug %}
<h5>Current User</h5>
<p>username: {{ current_user.username }}</p>
<p>firstname: {{ current_user.firstname }}</p>
<p>lastname: {{ current_user.lastname }}</p>
<p>country: {{ current_user.country }}</p>
<p>_id: {{current_user._id}}</p>

{% endblock %}